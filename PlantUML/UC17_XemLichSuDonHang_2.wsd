@startuml

title UC17: Xem lịch sử đơn hàng (luồng thay thế)

actor User
participant Frontend
participant OrderController
participant OrderService
database OrderDB

User -> Frontend: select status filter "confirmed"
Frontend -> OrderController: GET /api/orders?status=confirmed&page=1
OrderController -> OrderService: fetchUserOrders(userId, page, limit, "confirmed")
OrderService -> OrderDB: countDocuments({ user: userId, status: "confirmed" })
OrderService -> OrderDB: find({ user: userId, status: "confirmed" }).sort(...).skip(...).limit(...)
OrderDB --> OrderService: filtered items, total
OrderService --> OrderController: { items, total, page, limit }
OrderController -> Frontend: 200 { items, total, page, limit }
Frontend -> User: render filtered list
@enduml